<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø² Ú˜Ù† ØªØ§ Ø¬Ø§Ù†ØŒ Ø¹Ø´Ù‚</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-red: #ec4899; /* Pink-500 */
            --light-pink: #fbcfe8; /* Pink-200 */
        }
        /* Ø§Ø¹Ù…Ø§Ù„ ÙÙˆÙ†Øª Ø§ÛŒÙ†ØªØ± (Ø§Ú¯Ø±Ú†Ù‡ Ø¨Ø±Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ø¨Ù‡ ÛŒÚ© ÙÙˆÙ†Øª Ù…Ù†Ø§Ø³Ø¨ RTL Ù†ÛŒØ§Ø² Ø§Ø³ØªØŒ Ø§Ù…Ø§ ÙØ¹Ù„Ø§Ù‹ Inter Ø±Ø§ Ø­ÙØ¸ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…) */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fce7f3; /* Pink-100 */
            min-height: 100vh;
            /* Ensure alignment for the initial screen only */
            display: flex;
            justify-content: center;
            align-items: center;
            /* Allow vertical scroll for the challenge screen */
            overflow-x: hidden;
            padding: 0; /* Reset body padding for responsiveness */
        }
        /* Custom styles for the running heart button */
        #running-heart-btn {
            position: absolute;
            transition: transform 0.4s ease-in-out; /* Smooth transition */
            cursor: pointer;
            z-index: 10;
        }

        /* Custom styles for the slow-moving snail */
        @keyframes moveSnail {
            /* Ø¯Ø± RTL Ø­Ø±Ú©Øª Ø§Ø² Ø±Ø§Ø³Øª Ø¨Ù‡ Ú†Ù¾ Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø§Ù…Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ø±Ø§ Ø­ÙØ¸ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… */
            0% { transform: translateX(-100%); }
            100% { transform: translateX(calc(100% + 400px)); }
        }

        .snail-animation {
            /* 30 seconds to cross the screen, infinite loop, back and forth */
            animation: moveSnail 30s linear infinite alternate;
            position: absolute; /* Needed for animation keyframes */
        }

        /* Styling for the main content card */
        .challenge-card {
            background-color: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(236, 72, 153, 0.3); /* Pink shadow */
            max-width: 900px;
            width: 95%; /* Better mobile fit */
            margin: 2rem auto;
            align-self: flex-start; /* For when body is display: flex */
        }

        /* Lock icon styling */
        .lock-icon {
            font-size: 2rem;
        }

        /* Responsive body adjustment when challenge screen is shown */
        body.challenge-mode {
            display: block;
            padding: 1rem;
        }
    </style>
</head>
<body>

    <!-- Initial Screen: The Running Heart -->
    <div id="initialScreen" class="w-full h-screen flex justify-center items-center relative">
        <button id="running-heart-btn"
            class="p-6 rounded-full text-7xl bg-white shadow-xl hover:shadow-2xl active:scale-95 transition-all duration-300"
            onclick="handleInitialClick()">
            â¤ï¸
        </button>
        <p id="attempt-message" class="absolute bottom-10 text-xl font-semibold text-gray-700">
            Ø³Ø¹ÛŒ Ú©Ù† Ù‚Ù„Ø¨ Ø±Ùˆ Ø¨Ú¯ÛŒØ±ÛŒ! (Ú†Ù†Ø¯ Ø¨Ø§Ø± ØªÙ„Ø§Ø´ Ù…ÛŒâ€ŒØ®ÙˆØ§Ø¯...)
        </p>
    </div>

    <!-- Challenge Screen: The 4 Parts (Initially Hidden) -->
    <div id="challengeScreen" class="hidden challenge-card text-right">
        <h1 class="text-4xl font-bold text-center mb-10 text-pink-600">ğŸ’– Ø§Ø² Ú˜Ù† ØªØ§ Ø¬Ø§Ù†ØŒ Ø¹Ø´Ù‚ğŸ’–</h1>

        <!-- Part 1: True Love Challenge -->
        <div id="part1" class="border-b-2 border-pink-200 pb-8 mb-8">
            <h2 class="text-3xl font-semibold mb-4 text-pink-700">Û±. Ø¹Ø´Ú¯ ÙˆØ§Ú¯Ø¹ÛŒ</h2>
            <div id="part1-content">
                <p class="text-lg mb-4 text-gray-700">
                    Ø³ÙˆØ§Ù„: "Ú†Ù†Ø¯ ØªØ§ Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù… Ø§Ú¯Ù‡ Ø±Ø§Ø³Øª Ù…ÛŒÚ¯ÛŒØŸ (Ø¨ÛŒÙ† Û° ØªØ§ Û±Û°Û°Û°)"
                </p>
                <input type="number" id="love-count-input" placeholder="ÛŒÚ© Ø¹Ø¯Ø¯ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
                    class="p-3 border-2 border-pink-300 rounded-lg w-full md:w-1/3 focus:ring-pink-500 focus:border-pink-500 transition duration-150 text-left" dir="ltr">
                <button onclick="checkPart1()"
                    class="mt-4 md:mt-0 md:mr-4 bg-pink-500 text-white font-bold py-3 px-6 rounded-xl hover:bg-pink-600 transition-all duration-200 shadow-md active:scale-95">
                    Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø³Ø®
                </button>
                <div class="mt-4 flex items-center">
                    <span id="part1-lock" class="lock-icon">ğŸ”’</span>
                    <span id="part1-status" class="mr-3 text-red-500 font-medium">Ù‚ÙÙ„ Ø´Ø¯Ù‡</span>
                </div>
            </div>

            <!-- Success Content for Part 1 -->
            <div id="part1-success" class="hidden mt-6 p-4 bg-green-100 border-r-4 border-green-500 rounded-lg text-right">
                <div class="flex flex-col items-center space-y-4">
                    <img src="images/2222.png"
                         alt="Love Icon Placeholder"
                         class="rounded-lg shadow-lg">
                    <p class="text-xl font-bold text-green-700">Ù‚ÙÙ„ Ø¨Ø§Ø² Ø´Ø¯! ğŸ’•</p>
                    <p class="text-lg text-center text-gray-800">
                      ÛŒØ¯ÙˆÙ†Ù‡ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù… ÛŒØ¯ÙˆÙ†Ù‡ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù…ØŒ Ú†ÙˆÙ† ØªÙˆ ÛŒÚ¯Ø§Ù†Ù‡â€ŒØªØ±ÛŒÙ† Ùˆ Ø¨ÛŒâ€ŒÙ‡Ù…ØªØ§ØªØ±ÛŒÙ† Ù†Ø²ÛŒÙ‡Ù‡â€ŒØ§ÛŒ Ù‡Ø³ØªÛŒ Ú©Ù‡ Ø®Ø¯Ø§ÙˆÙ†Ø¯ Ø¯Ø± Ø¨ÛŒÙ† Û±Ù Û± ØªØ§ Ù†Ø²ÛŒÙ‡ Ø¨Ù‡ Ù…Ù† Ùˆ Ù…Ø§ Ù‡Ø¯ÛŒÙ‡ Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª.
                    </p>
                </div>
            </div>
        </div>

        <!-- Part 2: Heart Challenge -->
        <div id="part2" class="border-b-2 border-pink-200 pb-8 mb-8">
            <h2 class="text-3xl font-semibold mb-4 text-pink-700">Û². Ú†Ø§Ù„Ø´ Ú¯Ù„Ø¨</h2>
            <div id="part2-content">
                <p class="text-lg mb-4 text-gray-700">
                    â€œØ¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ø­Ø±ÙˆÙ "Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù…" ğŸ’–â€
                </p>
                <div class="flex items-center space-x-4">
                    <button id="part2-heart-btn" onclick="handlePart2Click()"
                        class="p-4 rounded-full text-4xl bg-white shadow-lg hover:shadow-xl hover:scale-105 active:scale-95 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                        <span id="part2-icon">âŒ</span>
                    </button>
                    <p class="text-2xl font-bold text-gray-800">
                        ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ÛŒÚ©â€ŒÙ‡Ø§: <span id="part2-click-count" class="text-pink-600" dir="ltr">0</span>
                    </p>
                </div>
                <div class="mt-4 flex items-center">
                    <span id="part2-lock" class="lock-icon">ğŸ”’</span>
                    <span id="part2-status" class="mr-3 text-red-500 font-medium">Ù‚ÙÙ„ Ø´Ø¯Ù‡ (Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø®Ø´ Û± Ø¯Ø§Ø±Ø¯)</span>
                </div>
            </div>

            <!-- Success Content for Part 2 -->
            <div id="part2-success" class="hidden mt-6 p-4 bg-yellow-100 border-r-4 border-yellow-500 rounded-lg text-right">
                <p class="text-xl font-bold text-yellow-700 mb-2">Ù‚ÙÙ„ Ø¨Ø§Ø² Ø´Ø¯!</p>
                <p class="text-lg text-gray-800">
                   Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù† 9 Ø¨Ø§Ø± Ù‚Ù„Ø¨Ù… Ø±Ùˆ Ø¨Ù‡ ØªÙ¾Ø´ Ø¯Ø±Ø§ÙˆØ±Ø¯ÛŒ Ø§Ù…Ø§ Ù†Ù…ÛŒØ¯ÙˆÙ†ÛŒ 10 Ø¨Ø±Ø§Ø¨Ø± Ø¨ÛŒØ´ØªØ±Ø´Ùˆ Ù‡Ø± Ø±ÙˆØ² Ù…ÙˆÙ‚Ø¹ Ø­Ø±Ù Ø²Ø¯Ù† Ø¨Ø§ Ù‡Ù… Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒØ¯ÛŒ Ú©Ù‡...ğŸ˜‹ğŸ«€
                </p>
            </div>
        </div>

        <!-- Part 3: Wish Challenge -->
        <div id="part3" class="border-b-2 border-pink-200 pb-8 mb-8">
            <h2 class="text-3xl font-semibold mb-4 text-pink-700">Û³. Ú†Ø§Ù„Ø´ Ø¢Ø±Ø²Ùˆ</h2>

            <form id="wish-form" onsubmit="handlePart3Submit(event)">
                <p class="text-lg mb-4 text-gray-700">
                    â€œØ¢Ø±Ø²ÙˆÛŒ Ø®ÙˆØ¯Øª Ø±Ùˆ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ âœ¨â€
                </p>
                <textarea id="wish-input" rows="3" placeholder="Ø¢Ø±Ø²ÙˆÛŒ Ø²ÛŒØ¨Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
                    class="p-3 border-2 border-pink-300 rounded-lg w-full focus:ring-pink-500 focus:border-pink-500 transition duration-150 mb-4" required
                    disabled></textarea>

                <button type="submit" id="wish-submit-btn"
                    class="bg-pink-500 text-white font-bold py-3 px-6 rounded-xl hover:bg-pink-600 transition-all duration-200 shadow-md active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled>
                    Ø§Ø±Ø³Ø§Ù„ Ø¢Ø±Ø²Ùˆ
                </button>
                <div class="mt-4 flex items-center">
                    <span id="part3-lock" class="lock-icon">ğŸ”’</span>
                    <span id="part3-status" class="mr-3 text-red-500 font-medium">Ù‚ÙÙ„ Ø´Ø¯Ù‡ (Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø®Ø´ Û² Ø¯Ø§Ø±Ø¯)</span>
                </div>
            </form>

            <!-- Success Content for Part 3 (Snail Animation) -->
            <div id="part3-success" class="hidden mt-6 p-4 bg-purple-100 border-r-4 border-purple-500 rounded-lg text-right">
                <div class="flex flex-col space-y-6">
                    <!-- Increased height for clearer animation -->
                    <div class="w-full h-20 overflow-hidden relative">
                        <!-- Snail Emoji with heart on shell moving -->
                        <span class="text-4xl snail-animation">â¤ï¸ğŸ¢</span>
                    </div>
                    <p class="text-xl text-center font-bold text-purple-700">
                        Ø¢Ø±Ø²ÙˆÛŒ ØªÙˆ ØªÙˆØ³Ø· Ø³Ø±ÛŒØ¹â€ŒØªØ±ÛŒÙ† Ù¾ÛŒÚ© Ù‚Ù„Ø¨â€ŒÙ‡Ø§ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú©Ø§Ø¦Ù†Ø§Øª Ø§Ø³Øª.
                    </p>
                </div>
            </div>
        </div>

        <!-- Part 4: Birthday Cake Challenge (New Section) -->
        <div id="part4" class="pt-8">
            <h2 class="text-3xl font-semibold mb-4 text-pink-700">Û´. ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú©ØŒ Ø¨Ø§ ØªÙ…Ø§Ù… Ø¨Ø±Ú¯Ø§ÛŒ Ù¾Ø§ÛŒÛŒØ² Ùˆ Ø¹Ø·Ø± Ú†Ø§ÛŒ</h2>
            <div id="part4-content">
                <p class="text-lg mb-4 text-gray-700">
                    Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ù¾ÛŒØ§Ù…ØŒ Ø±ÙˆÛŒ Ú©ÛŒÚ© Ú©Ù„ÛŒÚ© Ú©Ù†! ğŸ‚
                </p>
                <div class="flex items-center space-x-4">
                    <button id="part4-cake-btn" onclick="handlePart4Click()"
                        class="p-4 rounded-full text-4xl bg-white shadow-lg hover:shadow-xl hover:scale-105 active:scale-95 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                        <span id="part4-icon">âŒ</span>
                    </button>
                    <p class="text-xl font-bold text-gray-800">
                        ÙˆØ¶Ø¹ÛŒØª: <span id="part4-state" class="text-red-500">Ù‚ÙÙ„ Ø´Ø¯Ù‡</span>
                    </p>
                </div>
                <div class="mt-4 flex items-center">
                    <span id="part4-lock" class="lock-icon">ğŸ”’</span>
                    <span id="part4-status" class="mr-3 text-red-500 font-medium">Ù‚ÙÙ„ Ø´Ø¯Ù‡ (Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø®Ø´ Û³ Ø¯Ø§Ø±Ø¯)</span>
                </div>
            </div>

            <!-- Success Content for Part 4 (The Letter) -->
            <div id="part4-success" class="hidden mt-6 p-6 bg-pink-100 border-r-4 border-pink-500 rounded-lg text-right">
                <div class="flex flex-col items-center space-y-4">
                    <h3 class="text-3xl font-bold text-pink-700 mb-4 text-center">Ú†Ù†Ø¯ Ú©Ù„Ù…Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ØªØ±ÛŒÙ†Ù…!</h3>
                    <!-- Placeholder for 1111.png -->
                    <img src="images/1111.png"
                         alt="Placeholder for 1111.png"
                         class="rounded-xl shadow-lg border-4 border-pink-300">

                    <!-- Letter content will be injected here -->
                    <p id="birthday-letter-content" class="text-base text-gray-800 whitespace-pre-line leading-relaxed text-right w-full">
                        <!-- Content will be inserted by JS -->
                    </p>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Global State
        let attempts = 0;
        let part2Clicks = 0;
        const MAX_ATTEMPTS = 5;
        const TARGET_CLICKS = 9; // ØªØ¹Ø¯Ø§Ø¯ Ø­Ø±ÙˆÙ "Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù…"
        const TARGET_LOVE_COUNT = 1;

        // Elements
        const initialScreen = document.getElementById('initialScreen');
        const challengeScreen = document.getElementById('challengeScreen');
        const runningHeartBtn = document.getElementById('running-heart-btn');
        const attemptMessage = document.getElementById('attempt-message');

        // Part 1 Elements
        const part1Input = document.getElementById('love-count-input');
        const part1Lock = document.getElementById('part1-lock');
        const part1Status = document.getElementById('part1-status');
        const part1Success = document.getElementById('part1-success');

        // Part 2 Elements
        const part2HeartBtn = document.getElementById('part2-heart-btn');
        const part2Icon = document.getElementById('part2-icon');
        const part2ClickCount = document.getElementById('part2-click-count');
        const part2Lock = document.getElementById('part2-lock');
        const part2Status = document.getElementById('part2-status');
        const part2Success = document.getElementById('part2-success');

        // Part 3 Elements
        const wishForm = document.getElementById('wish-form');
        const wishInput = document.getElementById('wish-input');
        const wishSubmitBtn = document.getElementById('wish-submit-btn');
        const part3Lock = document.getElementById('part3-lock');
        const part3Status = document.getElementById('part3-status');
        const part3Success = document.getElementById('part3-success');

        // Part 4 Elements (NEW)
        const part4CakeBtn = document.getElementById('part4-cake-btn');
        const part4Icon = document.getElementById('part4-icon');
        const part4State = document.getElementById('part4-state');
        const part4Lock = document.getElementById('part4-lock');
        const part4Status = document.getElementById('part4-status');
        const part4Success = document.getElementById('part4-success');
        const part4LetterContainer = document.getElementById('birthday-letter-content');


        // --- UTILITY FUNCTIONS ---

        // Function to show a temporary message instead of alert()
        function showMessage(message, type = 'info') {
            const tempDiv = document.createElement('div');
            let bgColor = 'bg-blue-500';
            if (type === 'error') bgColor = 'bg-red-500';
            if (type === 'success') bgColor = 'bg-green-500';

            tempDiv.className = `fixed top-5 left-1/2 -translate-x-1/2 p-4 rounded-lg text-white font-bold shadow-2xl z-50 transition-all duration-300 ${bgColor} text-center`;
            tempDiv.textContent = message;

            document.body.appendChild(tempDiv);
            setTimeout(() => {
                tempDiv.classList.add('opacity-0');
                setTimeout(() => tempDiv.remove(), 300);
            }, 3000);
        }

        // --- INITIAL SCREEN LOGIC (Running Heart) ---

        function moveHeart() {
            // Get screen bounds for random positioning
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const btnSize = runningHeartBtn.offsetWidth;

            // Generate random positions within the visible area
            const newX = Math.random() * (screenWidth - btnSize * 1.5) + (btnSize * 0.25);
            const newY = Math.random() * (screenHeight - btnSize * 1.5) + (btnSize * 0.25);

            // Apply the new position using translation (better for performance)
            // We use clientWidth/Height for offset from center
            runningHeartBtn.style.transform = `translate(${newX - screenWidth / 2 + btnSize / 2}px, ${newY - screenHeight / 2 + btnSize / 2}px) scale(1)`;

            // Vague message, no click count revealed
            attemptMessage.textContent = `ÙØ±Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡! Ø³Ø¹ÛŒ Ú©Ù† Ù‚Ù„Ø¨ Ø±Ùˆ Ø¨Ú¯ÛŒØ±ÛŒ!`;
        }

        function handleInitialClick() {
            if (attempts < MAX_ATTEMPTS - 1) { // -1 because the last click is the successful one
                attempts++;
                moveHeart();
            } else {
                // Heart is now clickable!
                runningHeartBtn.style.position = 'static'; // Reset position
                runningHeartBtn.classList.add('hidden'); // Hide the heart
                initialScreen.classList.add('hidden'); // Hide the initial screen
                challengeScreen.classList.remove('hidden'); // Show the challenge screen
                document.body.classList.remove('flex', 'justify-center', 'items-center');
                document.body.classList.add('challenge-mode'); // Switch body to responsive mode
            }
        }

        // --- PART 1 LOGIC (Number 1) ---

        function checkPart1() {
            // Use parseInt for number comparison, but keep input value as string to be safe
            const inputValue = parseInt(part1Input.value.trim(), 10);

            if (inputValue === TARGET_LOVE_COUNT) {
                // Success
                part1Lock.textContent = 'ğŸ”“';
                part1Status.textContent = 'Ù‚ÙÙ„ Ø¨Ø§Ø² Ø´Ø¯!';
                part1Status.classList.remove('text-red-500');
                part1Status.classList.add('text-green-600');
                part1Input.disabled = true;
                part1Input.nextElementSibling.disabled = true; // Disable the button
                part1Input.classList.remove('border-pink-300');
                part1Input.classList.add('border-green-500', 'bg-green-50');
                part1Success.classList.remove('hidden');

                // Unlock Part 2
                unlockPart2();
                showMessage('Ú†Ø§Ù„Ø´ Û± ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯!', 'success');

            } else {
                // Failure
                showMessage('Ù†Ú†!Ø¬ÙˆØ§Ø¨ ÛŒÙ‡ Ú†ÛŒØ² Ø¯ÛŒÚ¯Ø³Øª', 'error');
                part1Input.value = ''; // Clear input for next attempt
            }
        }

        function unlockPart2() {
            part2HeartBtn.disabled = false;
            part2Icon.textContent = 'ğŸ’–';
            part2Lock.textContent = 'ğŸ”“';
            part2Status.textContent = 'Ù‚ÙÙ„ Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†!';
            part2Status.classList.remove('text-red-500');
            part2Status.classList.add('text-red-600');
        }

        // --- PART 2 LOGIC (9 Clicks) ---

        function handlePart2Click() {
            if (part2Clicks < TARGET_CLICKS) {
                part2Clicks++;
                part2ClickCount.textContent = part2Clicks;
                part2HeartBtn.classList.add('scale-110');
                setTimeout(() => part2HeartBtn.classList.remove('scale-110'), 100);

                if (part2Clicks === TARGET_CLICKS) {
                    // Success
                    part2HeartBtn.disabled = true;
                    part2Icon.textContent = 'âœ…';
                    part2Lock.textContent = 'ğŸ”“';
                    part2Status.textContent = 'ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯!';
                    part2Status.classList.remove('text-green-500');
                    part2Status.classList.add('text-green-500');
                    part2Success.classList.remove('hidden');

                    // Unlock Part 3
                    unlockPart3();
                    showMessage('Ú†Ø§Ù„Ø´ Û² ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯!', 'success');
                }
            }
        }

        // --- PART 3 LOGIC (Wish and Snail) ---

        function unlockPart3() {
            wishInput.disabled = false;
            wishSubmitBtn.disabled = false;
            part3Lock.textContent = 'ğŸ”“';
            part3Status.textContent = 'Ù‚ÙÙ„ Ù…Ù†ØªØ¸Ø± Ø§Ø±Ø²ÙˆØªÙ‡!';
            part3Status.classList.remove('text-red-500');
            part3Status.classList.add('text-red-500');
            wishInput.classList.add('bg-yellow-50');
        }

        function handlePart3Submit(event) {
            event.preventDefault(); // Stop form submission
            if (wishInput.disabled) return;

            const wish = wishInput.value.trim();

            if (wish) {
                // Hide the form elements
                wishForm.classList.add('hidden');

                // Show the success/animation area
                part3Success.classList.remove('hidden');

                // Unlock Part 4
                unlockPart4();
                showMessage('Ø¢Ø±Ø²ÙˆÛŒ Ø´Ù…Ø§ Ø¯Ø± Ø±Ø§Ù‡ Ø§Ø³Øª!', 'info');

            } else {
                showMessage('Ø±ÙˆØ² ØªÙˆØ¹Ù‡!Ø¨Ø¯ÙˆÙ† Ø¢Ø±Ø²Ùˆ Ù†Ù…ÛŒØ´Ù‡', 'error');
            }
        }

        // --- PART 4 LOGIC (Cake and Letter) ---

        function unlockPart4() {
            part4CakeBtn.disabled = false;
            part4Icon.textContent = 'ğŸ‚';
            part4Lock.textContent = 'ğŸ”“';
            part4Status.textContent = 'Ø§Ø®Ø±ÛŒÙ† Ù‚ÙÙ„ÛŒ Ú©Ù‡ Ù…Ù†ØªØ¸Ø±Ù‡ Ø¨Ø§Ø² Ø¨Ø´Ù‡!';
            part4Status.classList.remove('text-red-500');
            part4Status.classList.add('text-green-600');
            part4State.textContent = 'Ø¢Ù…Ø§Ø¯Ù‡!';
            part4State.classList.remove('text-red-500');
            part4State.classList.add('text-green-600');
        }

        function handlePart4Click() {
            part4Success.classList.remove('hidden');
            part4CakeBtn.disabled = true;
            part4Icon.textContent = 'ğŸ';
            showMessage('ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© :)', 'success');
        }


        // Long letter content for Part 4 - Persian translation provided by user
        const birthdayLetter = `Ø¯Ø§Ø´ØªÙ… ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ø±Ø¯Ù… Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¯Ø®ØªØ± Û²Û± Ø³Ø§Ù„Øª Ú©Ù‡ Ø¯Ùˆ Ø³Ø§Ù„ Ù¾ÛŒØ´Øª Ù†Ø¨ÙˆØ¯Ù‡ØŒ Ú†ÛŒ Ø¨Ù†ÙˆÛŒØ³Ù… Ú©Ù‡ Ø¨ØªÙˆÙ†Ù… Ø¯Ø±Ø³Øª Ù„Ù¾Ù Ù…Ø·Ù„Ø¨Ùˆ Ø¨Ø±Ø³ÙˆÙ†Ù…...
Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ú†Ù‚Ø¯Ø± Ø®Ø¯Ø§Ø±Ùˆ Ø´Ø§Ú©Ø±Ù… Ú©Ù‡ ØªÙˆ Ø´Ø¯ÛŒ Ø¨Ø®Ø´ÛŒ Ø§Ø² ÙˆØ¬ÙˆØ¯Ù….
ÛŒØ¹Ù†ÛŒ Ú˜Ù†Øª ØªÙˆ Ø¨Ø¯Ù† Ù…Ù†Ù‡Ù‡Ù‡ØŒ Ú¯Ø§Ù…ØªØ§Øª ØªÙˆ Ø¨Ø¯Ù† Ù…Ù†Ù‡Ù‡Ù‡ ğŸ˜„

Ø¨Ø¹Ø¯ Ù…Ø«Ù„Ø§Ù‹ ÛŒÚ©ÛŒ Ø§Ø²Ù… ØªØ¹Ø±ÛŒÙ Ú©Ù†Ù‡ Ø¨Ú¯Ù‡ Â«Ú†Ù‚Ø¯Ø± Ø®ÙˆØ´Ú¯Ù„ÛŒÂ»ØŒ Ø¹Ú©Ø³ØªÙˆ Ù†Ø´ÙˆÙ† Ø¨Ø¯Ù… Ø¨Ú¯Ù…: Â«Ø¨Ù‡ Ù…Ø§Ù…Ø§Ù†Ù… Ø±ÙØªÙ…!Â» ğŸ˜Œ

Ù…Ù‚Ø§ÛŒØ³Ù‡ Ú©Ø±Ø¯Ù† Ú©Ø§Ø± Ø¯Ø±Ø³ØªÙ‰ Ù†ÛŒØ³ØªØŒ Ø§Ù…Ø§ ÙˆÙ‚ØªÛŒ Ú©Ù†Ø§Ø± Ø¨Ù‚ÛŒÙ‡ Ù…ÛŒâ€ŒØ°Ø§Ø±Ù…Øª ØŒ Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† ÛŒÙ‡ Ø§Ù†Ø³Ø§Ù†ØŒ ÛŒÙ‡ Ù…Ø§Ø¯Ø±ØŒ ÛŒÙ‡ Ø¯Ø®ØªØ± Ùˆ ÛŒÙ‡ Ù‡Ù…Ø³Ø±ØŒ ØªÙˆ Ú©Ø§Ù…Ù„â€ŒØªØ±ÛŒÙ†Ù‰Ø›
Ú©Ø³ÛŒ Ú©Ù‡ Ø¨Ø§ Ù…Ù‡Ø±Ø¨ÙˆÙ†ÛŒ Ùˆ Ø§ÙˆÙ† Ù‚Ù„Ø¨ Ø¢Ù†Ø´Ø±Ù„ÛŒâ€Œ Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ù‡ØªØ±ÛŒÙ† Ø±Ø§Ù‡â€ŒÙ‡Ø§ Ø±Ùˆ Ù¾ÛŒØ¯Ø§ Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ùˆ Ø¨Ù‡ Ø¨Ù‚ÛŒÙ‡ Ù†Ø´ÙˆÙ† Ù…ÛŒØ¯Ù‡.

ÛŒÙ‡ Ù‡Ù…Ø¯Ù… Ø¨Ø±Ø§Ù‰ Ø¯Ø®ØªØ±Ø§Ø´ Ú©Ù‡ ØªÙˆ Ù‡Ø± Ù…ÙˆÙ‚Ø¹ÛŒØªÛŒ Ø¨Ø¯ÙˆÙ† Ù‚Ø¶Ø§ÙˆØª Ú¯ÙˆØ´ Ù…ÛŒØ¯Ù‡ØŒ
Ùˆ Ù‡Ù…ÛŒÙ† Ø¨Ø§Ø¹Ø« Ù…ÛŒØ´Ù‡ Ø­Ø±Ù Ø²Ø¯Ù† Ø¨Ø§Ù‡Ø§Ø´ ØµØ¯ Ø¨Ø±Ø§Ø¨Ø± Ø¯Ù„Ù†Ø´ÛŒÙ†â€ŒØªØ± Ùˆ Ù‚Ø´Ù†Ú¯â€ŒØªØ± Ø¨Ø´Ù‡.

ÛŒÙ‡ Ù‡Ù…Ø³Ø± Ú©Ù‡ Ø§Ø² Ø³Ù† Û±Û· Ø³Ø§Ù„Ú¯ÛŒ ØªÙˆ Ù‡Ù…Ù‡ Ù…Ø±Ø§Ø­Ù„ Ø²Ù†Ø¯Ú¯ÛŒ Ø­Ø¶ÙˆØ± Ø¯Ø§Ø´ØªÙ‡ Ùˆ Ù¾Ø´ØªÙˆØ§Ù†Ù‡ Ø¨ÙˆØ¯Ù‡ØŒ
Ùˆ ÛŒÙ‡ Ø¯Ø®ØªØ± Ù…ÙˆÙØ±ÙØ±ÛŒÙ Ù…Ø´Ú©ÛŒ Ú©Ù‡ Ù‡Ù…ÛŒØ´Ù‡ Ù‡Ù…Ø±Ø§Ø² Ù¾Ø¯Ø± Ùˆ Ù…Ø§Ø¯Ø± Ùˆ Ø®ÙˆØ§Ù‡Ø±Ø§Ø´ Ø¨ÙˆØ¯Ù‡ Ùˆ Ù‡Ø³Øª.

Ø§ÛŒÙ†â€ŒÙ‚Ø¯Ø± Ø®ÙˆØ¨ÛŒ Ú©Ù‡ Ø¯Ù„Ù… Ù…ÛŒâ€ŒØ®ÙˆØ§Ø¯ Ù…Ø­Ú©Ù… Ø¨ØºÙ„Øª Ú©Ù†Ù… Ùˆ Ø¨Ú¯Ù…:
Â«Ù…Ø§Ù…Ø§Ù† Ù†Ø²ÛŒ Ù†Ø²ÛŒÛŒÛŒØŒ ØªÙˆ ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ø®ÙˆØ¨ÛŒ ğŸ˜­ ØªÙˆ ÙˆØ§Ù‚Ø¹Ø§Ù‹ ØªÙˆ Ø²Ù†Ø¯Ú¯ÛŒØª Ø¨Ù‡ØªØ±ÛŒÙ† Ø¨ÙˆØ¯ÛŒ Ùˆ Ù‡Ø³ØªÛŒ!Â»

Ø§Ú¯Ø± ÛŒÙ‡ ÙˆÙ‚ØªØ§ÛŒÛŒ Ø­Ø³ Ú©Ø±Ø¯ÛŒ Ø²Ù†Ø¯Ú¯ÛŒ Ø¨ÛŒâ€ŒÙ…Ø¹Ù†ÛŒ ÛŒØ§ Ú©Ø³Ù„â€ŒÚ©Ù†Ù†Ø¯Ù‡â€ŒØ³ØªØŒ
Ø¨Ù‡ Ø§ÛŒÙ† ÙÚ©Ø± Ú©Ù† Ú©Ù‡ ØªÙˆ Ø§Ù…ÛŒØ¯ Ù…Ù†ÛŒØŒ Ù‡Ø¯Ù Ù…Ù†ÛŒ.
Ø¨Ø¯ÙˆÙ† ØªÙˆØŒ Ø¯Ø±ÛŒØ§ Ø­Ø§Ù„ Ù†Ù…ÛŒâ€ŒØ¯Ù‡.
Ø§ÙˆÙ† ÙÙ„Ø§Ú©Ø³ Ú†Ø§ÛŒ Ùˆ Ù¾Ø§ÛŒÙ‡ Ø¨ÙˆØ¯Ù† ØªÙˆ ØªÙˆÛŒ Ù‡Ø± Ù…ÙˆÙ‚Ø¹ÛŒØªÛŒØŒ ÙÙ‚Ø· Ø¨Ø§ Ø®ÙˆØ¯Øª Ù…Ø¹Ù†ÛŒ Ø¯Ø§Ø±Ù‡.

Ø¨Ø§ ØªÙˆØ¦Ù‡ Ú©Ù‡ Ù‡ÙˆØ§ØŒ Ø¨Ø±Ú¯Ø§ÛŒ Ù¾Ø§ÛŒÛŒØ²ØŒ Ø¯Ø±Ø®ØªØ§ Ùˆ Ú©Ù„Ø§ØºØ§ Ù…Ø¹Ù†ÛŒ Ù¾ÛŒØ¯Ø§ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø›
ÙˆÚ¯Ø±Ù†Ù‡ Ø§ÙˆÙ†Ø§ ÙÙ‚Ø· ÛŒÙ‡ Ø¯Ø±Ø®Øª Ùˆ ÛŒÙ‡ Ú©Ù„Ø§Øº Ø³Ø§Ø¯Ù‡â€ŒØ§Ù†.

Ø¨Ø§ ØªÙˆØ¦Ù‡ Ú©Ù‡ Ø­ØªÛŒ Ø®Ø±ÛŒØ¯ Ú©Ø±Ø¯Ù† Ø§Ø² ÛŒÙ‡ Ù…ØºØ§Ø²Ù‡â€ŒÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ù‡Ù… Ø®ÙˆØ´ Ù…ÛŒâ€ŒÚ¯Ø°Ø±Ù‡.

Ø®ÛŒÙ„ÛŒ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù…ØŒ Ø®ÛŒÙ„ÛŒ Ø²ÛŒØ§Ø¯.
Ø§Ù…Ø´Ø¨ Ú©Ù‡ Ø¯Ø§Ø±Ù… Ø§ÛŒÙ†Ùˆ Ù…ÛŒâ€ŒÙ†ÙˆÛŒØ³Ù…ØŒ
Ø¨Ù‡ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÛŒ ØªÙ…ÙˆÙ… Ø¨Ø±Ú¯Ø§ÛŒ Ø²Ø±Ø¯ Ùˆ Ø³Ø¨Ø² Ùˆ Ù†Ø§Ø±Ù†Ø¬ÛŒÙ Ø±ÙˆÛŒ Ø¯Ø±Ø®ØªØ§ØŒ
Ø§ÙˆÙ†Ø§ÛŒÛŒ Ú©Ù‡ ØªØ§Ø²Ù‡ Ø¯Ø§Ø±Ù† Ù…ÛŒâ€ŒØ§ÙØªÙ†ØŒ ÛŒØ§ Ø±ÙˆÛŒ Ø²Ù…ÛŒÙ† Ø¯Ø±Ø§Ø² Ú©Ø´ÛŒØ¯Ù†ØŒ
Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù… ğŸ’›

ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ø¨Ù‡ØªØ±ÛŒÙ†Ù…ØŒ
ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ùˆ Ù…Ø¨Ø§Ø±Ú©Ù…ÙˆÙ† ğŸ’
Ø¨Ù‡ØªØ±ÛŒÙ† Ø­Ø§Ù„Ø§ÛŒ Ø®ÙˆØ¨ Ø²Ù†Ø¯Ú¯ÛŒ Ù…Ø§Ù„ ØªÙˆ Ø¨Ø§Ø´Ù‡ â¤ï¸
`;


        // --- INITIALIZATION ---

        window.onload = () => {
             // Initial random positioning for the running heart
             moveHeart();
             
             // Inject letter content for Part 4
             if (part4LetterContainer) {
                 part4LetterContainer.textContent = birthdayLetter;
             }
        };

        // Ensure the heart resets to an initial random position if screen size changes
        window.addEventListener('resize', () => {
            if (!challengeScreen.classList.contains('hidden')) {
                // If the challenge screen is showing, do nothing with the heart position
                return;
            }
            // If the initial screen is showing, reposition the heart
            moveHeart();
        });

    </script>
</body>
</html>